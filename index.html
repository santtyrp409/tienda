<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Hamburgueser铆a</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
margin:0;
font-family:Poppins,sans-serif;
background:url("https://images.unsplash.com/photo-1550547660-d9450f859349") center/cover fixed;
}
body::before{
content:"";
position:fixed;
inset:0;
background:rgba(0,0,0,.55);
z-index:-1;
}
header{background:#e63946;color:#fff;padding:15px;text-align:center}
nav{display:flex;justify-content:center;gap:30px;background:#111;padding:10px}
nav button{background:none;border:none;color:#fff;font-weight:600;cursor:pointer}
.container{max-width:760px;margin:auto;padding:12px}
.card{
background:rgba(255,255,255,.28);
backdrop-filter:blur(4px);
border-radius:16px;
padding:14px;
margin-bottom:14px;
}
.item{cursor:pointer}
.opciones{display:none;margin-top:10px;border-top:1px dashed rgba(0,0,0,.3);padding-top:8px}
.opciones.active{display:block}
.extra-row{display:flex;justify-content:space-between;font-size:14px;margin-bottom:6px}
.extra-row input{width:60px}
.quitar{font-size:12px;opacity:.85;margin-top:6px}
button.accion{
width:100%;
margin-top:10px;
padding:10px;
border:none;
border-radius:12px;
background:#e63946;
color:#fff;
font-weight:600;
cursor:pointer;
}
input, textarea{
width:100%;
padding:8px;
margin-bottom:8px;
border-radius:8px;
border:none;
}
iframe{width:100%;height:220px;border-radius:12px;border:0}
ul{padding-left:18px}
</style>
</head>

<body>

<header>
<h1> Hamburgueser铆a</h1>
<p>Pedidos Online</p>
</header>

<nav>
<button onclick="mostrar('menu')">MEN</button>
<button onclick="mostrar('info')">INFORMACIN</button>
</nav>

<div class="container">

<section id="menu">
<div class="card item" onclick="toggle('cheese')">
<h3>Cheeseburger</h3>
<p>$5</p>
<small>2 carnes 路 4 cheddar</small>
<div id="cheese" class="opciones">
<div class="extra-row">Extra carne (+$2) <input type="number" min="0" value="0" data-p="2"></div>
<div class="extra-row">Extra cheddar (+$1) <input type="number" min="0" value="0" data-p="1"></div>
<button class="accion" onclick="agregar(event,'Cheeseburger',5,'cheese')">Agregar</button>
</div>
</div>
</section>

<section id="info" style="display:none" class="card">
<h3>Informaci贸n</h3>
<p> 19:00 a 23:30</p>
</section>

<section class="card">
<h3> Tu Pedido</h3>
<ul id="lista"></ul>
<p>Env铆o: $<span id="envio">0</span></p>
<p><strong>Total: $<span id="total">0</span></strong></p>
</section>

<section class="card">
<h3> Datos del cliente</h3>

<input id="nombre" placeholder="Nombre y Apellido">
<input id="direccion" placeholder="Direcci贸n y altura" onblur="actualizarMapa()">
<input id="entre" placeholder="Entre calles">

<button class="accion" onclick="usarUbicacion()"> Usar mi ubicaci贸n</button>

<iframe id="mapa" src="https://www.google.com/maps?q=Buenos%20Aires&output=embed"></iframe>

<textarea id="descripcion" placeholder="Descripci贸n de la casa"></textarea>

<label><input type="radio" name="pago" value="Transferencia"> Transferencia</label><br>
<label><input type="radio" name="pago" value="Efectivo" checked> Efectivo</label>

<button class="accion" onclick="confirmar()">Confirmar Pedido</button>
</section>

</div>

<script>
let pedido=[],totalFinal=0;
const localTienda={lat:-34.6037,lng:-58.3816};
let clienteLatLng=null;

function mostrar(id){
menu.style.display=id==="menu"?"block":"none";
info.style.display=id==="info"?"block":"none";
}

function toggle(id){
document.querySelectorAll('.opciones').forEach(o=>o.id!==id&&o.classList.remove('active'));
document.getElementById(id).classList.toggle('active');
}

function agregar(e,nombre,precio,id){
e.stopPropagation();
pedido.push({desc:nombre,precio});
actualizar();
}

function actualizar(){
lista.innerHTML="";
let sum=0;
pedido.forEach((p,i)=>{
sum+=p.precio;
lista.innerHTML+=`<li>${p.desc} $${p.precio} <button onclick="pedido.splice(${i},1);actualizar()">x</button></li>`;
});
let envio=calcularEnvio();
envioSpan.textContent=envio;
totalFinal=sum+envio;
total.textContent=totalFinal;
}

function actualizarMapa(){
let q=encodeURIComponent(direccion.value+" "+entre.value);
mapa.src=`https://www.google.com/maps?q=${q}&output=embed`;
guardarDatos();
}

function usarUbicacion(){
navigator.geolocation.getCurrentPosition(pos=>{
clienteLatLng={lat:pos.coords.latitude,lng:pos.coords.longitude};
mapa.src=`https://www.google.com/maps?q=${clienteLatLng.lat},${clienteLatLng.lng}&output=embed`;
actualizar();
guardarDatos();
});
}

function distanciaKm(a,b){
const R=6371;
const dLat=(b.lat-a.lat)*Math.PI/180;
const dLng=(b.lng-a.lng)*Math.PI/180;
const x=Math.sin(dLat/2)**2+
Math.cos(a.lat*Math.PI/180)*Math.cos(b.lat*Math.PI/180)*
Math.sin(dLng/2)**2;
return 2*R*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));
}

function calcularEnvio(){
if(!clienteLatLng) return 2;
let d=distanciaKm(localTienda,clienteLatLng);
if(d<=2) return 2;
if(d<=4) return 3;
return 4;
}

function guardarDatos(){
localStorage.setItem("cliente",JSON.stringify({
nombre:nombre.value,
direccion:direccion.value,
entre:entre.value,
descripcion:descripcion.value,
clienteLatLng
}));
}

(function cargar(){
let d=localStorage.getItem("cliente");
if(!d) return;
d=JSON.parse(d);
nombre.value=d.nombre||"";
direccion.value=d.direccion||"";
entre.value=d.entre||"";
descripcion.value=d.descripcion||"";
clienteLatLng=d.clienteLatLng;
if(clienteLatLng){
mapa.src=`https://www.google.com/maps?q=${clienteLatLng.lat},${clienteLatLng.lng}&output=embed`;
}
})();
</script>

</body>
</html>
